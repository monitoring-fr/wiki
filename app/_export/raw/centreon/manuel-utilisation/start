====== Manuel d'utilisation Centreon ======

===== Chapitre 1 - Installation =====

**[[:centreon:centreon-centos-install]]**


**[[:centreon:centreon-redhat-install]]**

===== Chapitre 2 - Interface =====

==== Accueil ====

=== Tactical Overview ===

Il s'agit de la vue d'accueil après s'être connecter à Centreon.

{{ :powered:centreon:manuel-utilisation:centreon_accueil1.png?700 }}

=== Santé Globale ===

Cette vue vous permet d'avoir en représentation dite en "camembert", un état de santé globale de votre supervision.

{{ :powered:centreon:manuel-utilisation:centreon_sante_globale.png?700 }}

=== Statistique de Nagios ===

Dans cette vue, vous allez retrouvez les performances de votre supervision (temps de check, latence ...) et des graphiques traçant l'historique de performance de chacun de vos instances.

  * Temps de check, latence

{{ :powered:centreon:manuel-utilisation:centreon_stat_performance.png?700 }}

  * Graphique de performance des "Pollers"

{{ :powered:centreon:manuel-utilisation:centreon_perf_graph_poller.png?700 }}


==== Supervision ====

La vue de Supervision va vous permettre d'accéder à vos hôtes et services supervisés. Plusieurs vues s'offrent à vous selon les préférences de chacun.

{{ :powered:centreon:manuel-utilisation:centreon_supervision.png?700 }}

=== Les Hôtes ===

{{ :powered:centreon:manuel-utilisation:centreon_supervision_hote.png?700 }}

=== Les services ===

{{ :powered:centreon:manuel-utilisation:centreon_supervision_service.png?700 }}

Petit passage sur la vue du détails d'un service

{{ :powered:centreon:manuel-utilisation:centreon_vue_service_details.png?700 }}

=== Les journaux d'évènements ===

Dans cette vue, vous aurez accès à tout l'historique des eventlogs concernant Centreon (Nagios)

{{ :powered:centreon:manuel-utilisation:centreon_journaux_evenements.png?700 }}

==== Vues ====

Cette vue permet de voir, créer, paramétrer des templates de graphiques pour les exploiter ensuite pour vos hôtes et services.

{{ :powered:centreon:manuel-utilisation:centreon_vue_graph.png?700 }}

==== Rapport ====

Cette vue vous permet d'avoir des statistiques de fiabilité sur une période de temps données.

{{ :powered:centreon:manuel-utilisation:centreon_vue_rapport.png?700 }}

==== Configuration ====

Le chapitre sur les vues de la configuration de Centreon est assez imposant car cette GUI est très complète ce qui peut la rendre complexe aux yeux des débutants.

=== Hôtes ===

Dans cette vue, vous allez pouvoir créer et paramétrer vos hôtes pour qu'ils soient ensuite injectés dans Nagios. Concernant la création d'un hôte, veuillez vous référer aux Chapitre 3 - **[[:centreon:manuel-utilisation:start#ajout-d-un-hote | Ajout d'un hôte]]**

{{ :powered:centreon:manuel-utilisation:centreon_conf_hote.png?700 }}

=== Services ===

Dans cette vue, vous allez pouvoir créer et paramétrer vos services pour qu'ils soient ensuite injectés dans Nagios. Concernant la création d'un service, veuillez vous référer aux Chapitre 3 - **[[:centreon:manuel-utilisation:start#ajout-d-un-service | Ajout d'un service]]**

{{ :powered:centreon:manuel-utilisation:centreon_conf_service.png?700 }}

=== Utilisateurs ===

Dans cette vue, vous allez pouvoir créer et paramétrer vos utilisateurs. Concernant la création d'un utilisateur, veuillez vous référer aux Chapitre 3 - **[[:centreon:manuel-utilisation:start#parametrage-d-un-compte-utilisateur-en-lecture-seule | Paramétrage d’un compte utilisateur en lecture seule]]**

{{ :powered:centreon:manuel-utilisation:centreon_conf_utilisateur.png?700 }}

=== Commandes ===

Dans cette vue, vous allez pouvoir créer et paramétrer vos commandes. Concernant la création d'une commande, veuillez vous référer aux Chapitre 3 - **[[:centreon:manuel-utilisation:start#ajout-d-une-commande | Ajout d'une commande]]**

{{ :powered:centreon:manuel-utilisation:centreon_conf_commande.png?700 }}

=== Notifications ===

Pour des explications sur le contenu de cette vue --> cf:image ci-dessous

{{ :powered:centreon:manuel-utilisation:centreon_conf_notif.png?700 }}

=== Nagios ===

La vue suivante vous permet de gérer la configuration générale, les ressources de nagios et d'injecter la configuration Centreon dans le répertoire etc de nagios pour qu'il prenne en compte vos modifications. Mais toute cette partie là est expliquée plus en détails dans le Chapitre 3 - **[[:centreon:manuel-utilisation:export-centreon-nagios | Export de la configuration Centreon vers Nagios]]**

{{ :powered:centreon:manuel-utilisation:centreon_conf_nagios.png?700 }}

=== Centreon ===

La vue suivante s'appelle Centreon mais est plus orienté sur la gestion de NDO et de la supervision en mode distribuée. On peut y déclarer des collecteurs. Cette partie est détaillée dans le Chapitre 3 - **[[:centreon:manuel-utilisation:centreon-supervision-distribuee | Comment passer sa supervision Centreon en Distribuée ?]]**

{{ :powered:centreon:manuel-utilisation:centreon_conf_centreon.png?700 }}

==== Administration ====

=== Options ===

On retrouve dans cette vue les points de configurations fondamentaux de Centreon (le répertoire où il est installé, options d'affichage, etc ....)

{{ :powered:centreon:manuel-utilisation:centreon_admin_options.png?700 }}

=== Modules ===

Cette vue sert à créer vos modules pour les greffer à Centreon.

{{ :powered:centreon:manuel-utilisation:centreon_admin_modules.png?700 }}

=== ACL ===

Dans cette vue, vous pourrez gérer les rôles et droits d'accès pour vos utilisateurs.

{{ :powered:centreon:manuel-utilisation:centreon_admin_acl.png?700 }}

=== Base de données ===

Cette vue vous permet de garder un oeil sur la taille de votre base NDO. Grâce à cela, vous pourrez réagir si ça taille devient trop imposante (ce qui pourrait conduire à des pertes de performances).

{{ :powered:centreon:manuel-utilisation:centreon_admin_bdd.png?700 }}

=== Sessions ===

Comme son nom l'indique, cette vue vous permet de voir les utilisateurs se connectant sur le portail de supervision.

{{ :powered:centreon:manuel-utilisation:centreon_admin_sessions.png?700 }}

=== Etat du serveur ===

Cette vue vous permet d'avoir un état de santé globale de votre serveur Centreon sans avoir à aller dans un terminal et taper des commandes linux.

{{ :powered:centreon:manuel-utilisation:centreon_admin_etat_serv.png?700 }}

=== A propos ===

Petite page bien utile qui présence tout d'abord les contributeurs de ce projet. Mais cette page rassemble des outils bien utiles comme le Wiki de Centreon par exemple.

{{ :powered:centreon:manuel-utilisation:centreon_a_propos.png?700 }}

===== Chapitre 3 - Prise en main =====

==== Ajout d'un hôte ====

La configuration d’un hôte peut être assez fastidieuse car elle comporte un grand nombre de paramètres à fixer. Cependant, il est possible et fortement recommandé d’utiliser les templates (modèles) pour les hôtes afin de faciliter le travail. Ces modèles permettent de définir les paramètres par défaut. De base, Centreon définit tout un ensemble de templates, dans le cadre du projet, nous utilisons, pour le moment le template « generic-host ».

Nous précisons les paramètres essentiels pour configurer un hôte.

{{ :powered:centreon:manuel-utilisation:centreon_ajout_hote.png?700 }}

**Nom de l’hôte :** C’est le nom qui va l’identifier pour Nagios et Centreon

**Alias :** Le « surnom » de l’hôte. On peut aussi mettre des informations supplémentaires (localisation…)

**Adresse IP/DNS :** l’adresse IP

**Surveillé depuis :** Le collecteur qui va le superviser

**Modèle multiple de l’hôte :** Le template attaché pour cet hôte. Il faut prendre « generic-host » par défaut.

Une fois ces paramètres renseignés, il est possible d’attacher, si nécessaires cet hôte à un ou des groupes (champ Groupe d'hôtes parent). Il est aussi possible de définir une « généalogie » pour les hôtes : on définit des hôtes parents et /ou enfants. Cette notion permet de définir une cartographie (ou plutôt généalogie) des hôtes.

Ex : On définit comme père un switch. Tous les serveurs « fils » connectés au switch ne seront plus supervisés si celui-ci tombe.

{{ :powered:centreon:manuel-utilisation:centreon_ajout_hote_relations.png?700 }}

==== Ajout d'un groupe d'hôtes ====

Il est souvent pratique de regrouper les hôtes pour améliorer l’affichage et la gestion des services dans Centreon. Par exemple, on peut souhaiter regrouper les hôtes par type d’OS, par environnements applicatifs, par type de matériels…

Pour ajouter ou modifier un groupe d’hôtes, il faut se rendre dans l’onglet Configuration → Hôtes → Groupe d’hôtes. Il suffit ensuite de compléter la page, en spécifiant le nom du groupe, son alias (« surnom ») et les membres de ce groupe.

{{ :powered:centreon:manuel-utilisation:centreon_ajout_grp_hotes.png?700 }}

==== Ajout d'une commande ====

Un service, dans Centreon (ou Nagios) définit une tâche « logique » à effectuer sur un hôte (contrôle d’un serveur web, contrôle des données systèmes…). Le travail réel est effectué par le plugin (programme, script… sur le collecteur ou en local sur l’hôte, par exemple check_http pour le contrôle d’un service web). Pour faire le lien entre le service et le plugin qui doit être lancé, il faut définir des commandes. Une commande correspond à l’exécution du plugin en ligne de commande, avec les paramètres nécessaires.

Pour ajouter ou modifier une commande, il faut se rendre dans l’onglet Configuration → Commandes → Contrôles. Sur la page s’affiche toutes les commandes déjà connues et qu’il est possible de modifier.

{{ :powered:centreon:manuel-utilisation:centreon_ajout_commande.png?700 }}

Si on souhaite ajouter une commande, il suffit de cliquer sur ajouter.

{{ :powered:centreon:manuel-utilisation:centreon_ajout_commande1.png?700 }}

Les paramètres pour la définition d’une commande sont les suivantes :

**Nom de la commande :** c’est le nom qui va être sélectionnable quand nous allons définir un service.

**Ligne de commande :** c’est ici que l’on construit la commande qui va être lancée par Nagios. Centreon propose des menus déroulants afin de faciliter cette construction.
  * Le premier menu donne accès aux macros utilisateurs (par défaut la macro $USER1$ contient le chemin des plugins).
  * Le deuxième menu permet de sélectionner le plugin qui doit être utilisé.
  * Le troisième menu permet de sélectionner les macros disponibles dans Nagios (ex $HOSTADDRESS$).

**Exemple d’arguments :** Ces deux cases permettent de tester une commande et de définir les valeurs par défaut lors de la définition d’un service.

**Type de commande :** On laisse la valeur par défaut « vérification ».

**Modèle de graphique :** On peut laisser ce champ vide ou utiliser un des modèles proposés.

==== Ajout d'un service ====

Une fois l’hôte et la commande renseignés, nous allons pouvoir définir un service attaché au serveur supervisé. Pour ajouter ou modifier un service, il faut se rendre dans l’onglet Configuration → Services. Sur la page s’affiche tous les services par hôte.

{{ :powered:centreon:manuel-utilisation:centreon_ajout_service.png?700 }}

Pour ajouter un service, il suffit donc de sélectionner Ajouter et de commencer la configuration. Comme pour les hôtes, il y a un grand nombre de paramètres à définir. Il est donc aussi fortement conseillé d’utiliser les templates pour faciliter la configuration du service. Par défaut nous utilisons le template generic-service. 

Sur la page Configuration du service, nous allons renseigner les paramètres suivants :

**Description :** C’est le nom du service qui sera affiché dans la page de supervision

**Modèle de service :** Le template utilisé, par défaut nous prenons generic-service.

**Commande de vérification :** c’est ici que l’on précise la commande à utiliser.

**Arguments :** les arguments de la commande. Le format est  !arg1 !arg2 !arg3 !....

Pour les options de notifications, si elle sont différentes de celle du template :

**Contacts liés :** les contacts à notifier

**Groupe de contacts liés :** les groupes de contacts à notifier

{{ :powered:centreon:manuel-utilisation:centreon_ajout_service1.png?700 }}

Sur la page Relations, nous allons faire le lien entre le service et le/les hôtes. Il est possible d’attacher un service à un ou plusieurs et à un ou plusieurs groupes d’hôtes.
NB : si un service est attaché à un groupe d’hôte, il apparaîtra dans le sous-menu Services par Groupe d’hôtes et non pas Services par hôte.

{{ :powered:centreon:manuel-utilisation:centreon_ajout_service_relations.png?700 }}

==== Suppression d'un service ====

Ce paragraphe traite de la manière de supprimer un service pour un ou plusieurs hôtes ou groupe d’hôtes. Lorsque l’on se connecte sur la page de configuration de services, nous voyons les services définis pour les hôtes. Il y a deux « types » de services : ceux qui sont liés à un seul hôte et ceux qui sont liés à un ensemble d’hôtes (ceux-ci apparaissent surlignés en orange).

Dans la capture d’écran ci-dessous, nous pouvons voir que les service /, load et memory sont attachés uniquement à l’hôte Centreon. Par contre le service ping est attaché à Centreon mais aussi à d’autres machines (deuxième capture d’écran).

{{ :powered:centreon:manuel-utilisation:centreon_suppression_service.png?700 }}

Pour supprimer le service load, il suffirait de le sélectionner et de choisir Supprimer dans l’onglet Plus d’actions. Par contre, dans le cas du service ping, si on effectue la même action, nous allons supprimer le service non seulement pour l’hôte Centreon mais aussi pour tous les hôtes pour lesquels le service est attaché.

Si on souhaite supprimer le service ping uniquement pour l’hôte Centreon, il faut modifier la définition du service, en allant dans l’onglet Relations et en supprimant l’hôte Centreon de la sélection.

{{ :powered:centreon:manuel-utilisation:centreon_suppression_service1.png }}

==== Mise à jour de la configuration ====

Lorsque l’on modifie la configuration dans Centreon, on ne fait que modifier l’état de la base Centreon. Les modifications ne sont pas encore prises en compte par les différents collecteurs Nagios. Pour effectuer cette mise à jour, il faut se rendre : **Configuration → Nagios → Générer**

{{ :powered:centreon:manuel-utilisation:centreon_maj_conf.png?700 }}

Il est possible de choisir sur quel collecteur (ou bien tous), nous souhaitons générer la configuration. Il est possible de seulement générer la configuration sans redémarrer les collecteurs Nagios ou de redémarrer aussi les collecteurs (on coche Redémarrer Nagios et on choisit ma méthode Redémarrer). Une fois la sélection faite, on valide en cliquant sur Exporter.

==== Paramétrage d’un compte utilisateur en lecture seule ====

=== Création du compte ===

Tout d’abord, il faut que l’on créé un compte utilisateur de consultation dans centreon. Il faut aller dans l’onglet **Configuration --> Utilisateurs --> Ajouter**

{{ :powered:centreon:manuel-utilisation:centreon_compte_lecture_seule.png?700 }}

Ensuite, nous allons renseigner notre utilisateur comme ci-dessous (cf capture) :

**Nom complet :** Henri_Dicule

**Alias/login :** Henri_Dicule

**Email :** henri.dicule@localhost (adresse factice)

**Autorisé à se connecter à l’interface Web :** Oui

**Mot de passe :** hdicule

**Administrateur :** Non

**Options de notifications d’hôte :** None

**Période de notifications d’hôte :** none

**Commande de notification d’hôte :** host-notify-by-email

**Options de notifications de service :** None

**Période de notifications de service :** none

**Commande de notification de service :** service-notify-by-email

{{ :powered:centreon:manuel-utilisation:centreon_compte_lecture_seule1.png?700 }}

Maintenant que notre compte est créé, nous allons nous intéresser à ces droits.

=== Gestion des ACL (mode en lecture seule) ===

== Création du groupe d’accès ==

Il faut créer un groupe d’accès pour y rattacher notre compte. Il faut aller dans l’onglet **Administration --> ACL --> Gestion des groupes d’accès --> Ajouter**

{{ :powered:centreon:manuel-utilisation:centreon_compte_lecture_seule_acl.png?700 }}

Ensuite, il faut déclarer le groupe d’accès comme ci-dessous :

{{ :powered:centreon:manuel-utilisation:centreon_compte_lecture_seule_acl1.png?700 }}

== Création du paramétrage « lecture seule » ==

Il faut aller dans l’onglet **Administration --> ACL --> Gestion des accès aux menus --> Ajouter**

{{ :powered:centreon:manuel-utilisation:centreon_compte_lecture_seule_acl2.png?700 }}

Il faut paramétrer l’accès aux différentes vues comme ci-dessous :

{{ :powered:centreon:manuel-utilisation:centreon_compte_lecture_seule_acl3.png?700 }}

== Paramétrage de visualisation du contenu ==

Il est possible dans centreon d’autoriser à un utilisateur la vsualisation d’une ou plusieurs machines. Pour se faire, il faut procéder de la manière suivante :

Aller dans **Administration --> ACL --> Gestion des accès aux ressources --> Ajouter**

{{ :powered:centreon:manuel-utilisation:centreon_compte_lecture_seule_acl4.png?700 }}

Dans l’onglet Informations Générales, rentrer les informations comme ci-dessous :

{{ :powered:centreon:manuel-utilisation:centreon_compte_lecture_seule_acl5.png?700 }}

Ensuite, dans l’onglet Hosts Resources, vous allez pouvoir définir quels hôtes votre utuilisateur à le droit de voir.

{{ :powered:centreon:manuel-utilisation:centreon_compte_lecture_seule_acl6.png?700 }}

Même chose pour les services, aller dans Services Resources :

{{ :powered:centreon:manuel-utilisation:centreon_compte_lecture_seule_acl7.png?700 }}

Vous pouvez maintenant sauvegarder, pensez à Recharger les ACL  et essayer votre nouveau compte utilisateur.

==== Personnaliser l'apparence des courbes ====

<note>
Ceci est la documentation pour la version 2.1.x. La gestion des courbes à un peu changé dans Centreon 2.2. 
</note>

Dans Centreon, à partir du moment ou vos plugins remontent des données de performance, il est possible d'obtenir des courbes affichant l'évolution des mesures dans le temps. Par exemple si vous surveillez le trafic des interfaces de vos routeurs, le plugin renvois deux données de performances : le trafic en entrées et en sortie. Centreon utilise ces données pour alimenter des bases rrd et utilise le contenu de ces bases pour générer des graphiques. 

Le problème est que Centreon génère les graphiques possédant plusieurs courbe avec une seule couleur pour l'ensemble des courbes. Cela n'aide pas forcément à interpréter ce type de graphique par exemple :

{{:centreon:manuel-utilisation:selection_001.png?nolink|}}

Centreon nous aide (un peu) à personnaliser les couleurs des différentes courbes). Pour cela il faut aller dans : le menu vue puis graphiques puis courbes. 

{{:centreon:manuel-utilisation:selection_002.png?nolink|}}

Centreon affiche ensuite la liste des modèles de courbes et leurs principales propriétés :

{{ :centreon:manuel-utilisation:selection_003.png?nolink& |}}




